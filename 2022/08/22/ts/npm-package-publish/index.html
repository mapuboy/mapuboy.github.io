<!DOCTYPE HTML>
<html lang="en">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="用TS构建与发布NPM包, Hexo">
    <meta name="description" content="
Step by step: Building and publishing an NPM Typescript package.From: https://itnext.io/step-by-step-building-and-publi">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>用TS构建与发布NPM包 | Hexo</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 6.2.0"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Hexo</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>Index</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>Tags</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>Categories</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>Archives</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>About</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>Contact</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>Friends</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="Search" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Hexo</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			Index
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			Tags
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			Categories
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			Archives
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			About
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			Contact
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			Friends
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/19.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">用TS构建与发布NPM包</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/ts/">
                                <span class="chip bg-color">ts</span>
                            </a>
                        
                            <a href="/tags/typescript/">
                                <span class="chip bg-color">typescript</span>
                            </a>
                        
                            <a href="/tags/npm/">
                                <span class="chip bg-color">npm</span>
                            </a>
                        
                            <a href="/tags/node/">
                                <span class="chip bg-color">node</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/Typescript/" class="post-category">
                                Typescript
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>Publish Date:&nbsp;&nbsp;
                    2022-08-22
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.min.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <blockquote>
<p>Step by step: Building and publishing an NPM Typescript package.<br>From: <a target="_blank" rel="noopener" href="https://itnext.io/step-by-step-building-and-publishing-an-npm-typescript-package-44fe7164964c">https://itnext.io/step-by-step-building-and-publishing-an-npm-typescript-package-44fe7164964c</a>   </p>
</blockquote>
<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>In this guide, we will build a reusable module in Typescript and publish it as a <strong>Node.js</strong> package. I’ve seen it being done in many different ways so I want to show you how you can use the best practices and tools out there to create your own package, step by step using <strong>Typescript</strong>, <strong>Tslint</strong>, <strong>Prettier</strong> and <strong>Jest.</strong></p>
<p>This is what we are going to build:<br><a target="_blank" rel="noopener" href="https://www.npmjs.com/package/my-awesome-greeter">https://www.npmjs.com/package/my-awesome-greeter</a><br><a target="_blank" rel="noopener" href="https://github.com/caki0915/my-awesome-greeter">https://github.com/caki0915/my-awesome-greeter</a></p>
<h1 id="What-is-NPM"><a href="#What-is-NPM" class="headerlink" title="What is NPM?"></a>What is NPM?</h1><p>Npm is the package manager for Javascript and the world biggest library of reusable software code. It’s also a great as build tool itself as I will show later on.</p>
<h1 id="Why-Typescript"><a href="#Why-Typescript" class="headerlink" title="Why Typescript?"></a>Why Typescript?</h1><p>As a superset to Javascript, Typescript provides optional typing and deep intellisense. When it comes to package development, this is my personal opinion:</p>
<blockquote>
<p><mark class="xj xk nw"><strong class="it jn">I believe that all packages should be built in Typescript</strong></mark></p>
</blockquote>
<figure class="hg hh hi hj hk hl">
    <iframe src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fgiphy.com%2Fembed%2FSqmkZ5IdwzTP2%2Ftwitter%2Fiframe&display_name=Giphy&url=https%3A%2F%2Fgiphy.com%2Fgifs%2Freaction-what-despicable-me-SqmkZ5IdwzTP2&image=https%3A%2F%2Fmedia.giphy.com%2Fmedia%2FSqmkZ5IdwzTP2%2Fgiphy.gif&key=a19fcc184b9711e1b4764040d3dc5c07&type=text%2Fhtml&schema=giphy" allowfullscreen="" frameborder="0" height="356" width="435" title="Despicable Me Reaction GIF - Find & Share on GIPHY" class="t u v ky aj" scrolling="auto"></iframe>
</figure>

<p>Some of you might feel that strong typing decreases productivity and it’s not worth the effort to use. I can agree when it comes to small-scale projects, however, when it comes to package-development, Typescript has some serious advantages:</p>
<ul>
<li>More robust code and easier to maintain.</li>
<li>The package can be used both for Typescript and Javascript users! If your library becomes popular there will sooner or later be a demand for type-definitions, and to write those manually is time-consuming, error-prone and harder to update.</li>
<li>With type-definitions in the package, the user doesn’t have to download the types from another package.</li>
<li>Strong typings are more self-documenting and makes the code more understandable.</li>
<li>Even if the one using your package doesn’t use Typescript, some editors, like <strong>Visual Studio Code</strong> will still use the type-definitions to give the user better intellisense.</li>
</ul>
<h1 id="Alright-Let’s-get-started"><a href="#Alright-Let’s-get-started" class="headerlink" title="Alright. Let’s get started!"></a>Alright. Let’s get started!</h1><p>Make sure you have the latest version of node and npm.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">node</span> -v  
<span class="token number">10.0</span>.0npm -v  
<span class="token number">6.0</span>.0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h1 id="Pick-a-great-name"><a href="#Pick-a-great-name" class="headerlink" title="Pick a great name"></a>Pick a great name</h1><p>This might be harder than it sounds. Package names has to be in pascal-case and in lowercase. Since there are 700k+ packages, make a quick search on <a target="_blank" rel="noopener" href="https://www.npmjs.com/">https://www.npmjs.com/</a> to make sure your awesome name is not already taken. For the sake of this guide, I will choose the name <strong>my-awesome-greeter,</strong> but use a unique name so you can publish your package to npm later on <strong>😉.</strong></p>
<h1 id="Basic-Setup"><a href="#Basic-Setup" class="headerlink" title="Basic Setup"></a>Basic Setup</h1><p>Create your package folder with a suitable name</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mkdir</span> **my-awesome-greeter** <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> **my-awesome-greeter**<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h1 id="Create-a-git-repository"><a href="#Create-a-git-repository" class="headerlink" title="Create a git repository"></a>Create a git repository</h1><p>First thing first. You need a remote git repository for your package so it can be downloaded. Creating a remote git repository is out of scope for this article but once you have done it you can use the following lines to initialize your local repository and set your remote origin.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> init  
<span class="token builtin class-name">echo</span> <span class="token string">"**\# My Awesome Greeter**"</span> <span class="token operator">>></span> README.md  
<span class="token function">git</span> <span class="token function">add</span> <span class="token builtin class-name">.</span> <span class="token operator">&amp;&amp;</span> <span class="token function">git</span> commit -m <span class="token string">"Initial commit"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>Replace <strong><Git Repository Url></strong> with ****the URL to your remote repository.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> remote <span class="token function">add</span> origin **<span class="token operator">&lt;</span>Git Repository Url<span class="token operator">></span>**  __git push -u origin master<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h1 id="Init-your-Package"><a href="#Init-your-Package" class="headerlink" title="Init your Package"></a>Init your Package</h1><p>Let’s create a <strong>package.json</strong> file with all default values.<br>We’re going to modify this one later on.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> init -y<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>As the last step, we’re going to add a <strong>.gitignore</strong> file to the root. There’s a lot <strong>.gitignore</strong> templates out there but I like to keep it simple and don’t add more than you need. At the moment, we only need to ignore the <strong>node_modules</strong> folder.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> **<span class="token string">"node_modules"</span>** <span class="token operator">>></span> .gitignore<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Awesome! We got the basics 😃 This is how it looks like when I open the project in Visual Studio Code. From now on I will continue adding files from vscode from now on rather than using the console, but choose a style that suits you 😉</p>
<figure class="hg hh hi hj hk hl cx cy paragraph-image">
    ![](https://miro.medium.com/max/60/1*URQvNrvfDbowYd0VDfZKdA.png?q=20)![](https://miro.medium.com/max/1400/1*URQvNrvfDbowYd0VDfZKdA.png)
    <figcaption class="lg lh cz cx cy li lj ce b fa cg gr" data-selectable-paragraph="">My Awesome Greeter in vscode</figcaption>
</figure>

<figure class="hg hh hi hj hk hl cx cy paragraph-image">
    ![](https://miro.medium.com/max/60/1*Ab7k2KaKYuZ1P6NAgyD_eA.png?q=20)![](https://miro.medium.com/max/1400/1*Ab7k2KaKYuZ1P6NAgyD_eA.png)
    <figcaption class="lg lh cz cx cy li lj ce b fa cg gr" data-selectable-paragraph="">My repository in Github</figcaption>
</figure>

<h1 id="Add-Typescript-as-a-DevDependency"><a href="#Add-Typescript-as-a-DevDependency" class="headerlink" title="Add Typescript as a DevDependency"></a>Add Typescript as a DevDependency</h1><p>Let’s start with typescript as a dependency</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev typescript<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>The flag <code>--save-dev</code> will tell NPM to install Typescript as a <strong>devDependency</strong>. The difference between a devDependency and a dependency is that devDependencies will only be installed when you run <strong>npm install</strong>, but not when the end-user installs the package.<br>For example, Typescript is only needed when developing the package, but it’s not needed while using the package.</p>
<p>Good! Now you will see a <strong>node_modules</strong> folder and a <strong>package-lock.json</strong> in your root as well.</p>
<p>In order to compile Typescript we also need a <strong>tsconfig.json</strong> file so let’s add it to the project root:</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>  
  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>  
    <span class="token property">"target"</span><span class="token operator">:</span> <span class="token string">"es5"</span><span class="token punctuation">,</span>  
    <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"commonjs"</span><span class="token punctuation">,</span>  
    <span class="token property">"declaration"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  
    <span class="token property">"outDir"</span><span class="token operator">:</span> <span class="token string">"./lib"</span><span class="token punctuation">,</span>  
    <span class="token property">"strict"</span><span class="token operator">:</span> <span class="token boolean">true</span>  
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  
  <span class="token property">"include"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"src"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  
  <span class="token property">"exclude"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"node_modules"</span><span class="token punctuation">,</span> <span class="token string">"**/__tests__/*"</span><span class="token punctuation">]</span>  
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<figure class="hg hh hi hj hk hl cx cy paragraph-image">
    ![](https://miro.medium.com/max/60/1*-08hw4_EGpy3OmHwUWhH8A.png?q=20)![](https://miro.medium.com/max/1400/1*-08hw4_EGpy3OmHwUWhH8A.png)
</figure>

<p>A lot of things is going on here, so let’s explain our config file:<br><strong>target</strong>: We want to compile to <strong>es5</strong> since we want to build a package with browser compatibility.<br><strong>module</strong>: Use commonjs for compatibility.<br><strong>declaration</strong>: When you building packages, this should be true. Typescript will then also export type definitions together with the compiled javascript code so the package can be used with both Typescript and Javascript.<br><strong>outDir</strong>: The javascript will be compiled to the lib folder.<br><strong>include:</strong> All source files in the src folder<br><strong>exclude:</strong> We don’t want to transpile node_modules, neither tests since these are only used during development.</p>
<h1 id="Your-first-code"><a href="#Your-first-code" class="headerlink" title="Your first code!"></a>Your first code!</h1><p>Now when we have the compilation set up, we can add our first line of code.<br>Let’s create a <code>src</code> folder in the root and add an index.ts file:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> const Greeter <span class="token operator">=</span> <span class="token punctuation">(</span>name: string<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable"><span class="token variable">`</span>Hello $<span class="token punctuation">&#123;</span>name<span class="token punctuation">&#125;</span><span class="token variable">`</span></span><span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Ok, it’s a good start. Next step is to add a build script to <strong>package.json:</strong></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token string">"build"</span> <span class="token builtin class-name">:</span> <span class="token string">"tsc"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<figure class="hg hh hi hj hk hl cx cy paragraph-image">
    ![](https://miro.medium.com/max/60/1*MMQ2Bqnly179jXu319rj3A.png?q=20)![](https://miro.medium.com/max/1400/1*MMQ2Bqnly179jXu319rj3A.png)
</figure>

<p>Now you can run the build command in the console:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> run build<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>And violá!</p>
<p>You will see a new <strong>lib</strong> folder in the root with your compiled code and type definitions!</p>
<figure class="hg hh hi hj hk hl cx cy paragraph-image">
    ![](https://miro.medium.com/max/60/1*-Cat1X8ZnFC0hTwonH0WFA.png?q=20)![](https://miro.medium.com/max/1400/1*-Cat1X8ZnFC0hTwonH0WFA.png)
</figure>

<h1 id="Ignore-compiled-code-in-git"><a href="#Ignore-compiled-code-in-git" class="headerlink" title="Ignore compiled code in git"></a>Ignore compiled code in git</h1><p>Except for <strong>package-lock.json</strong>, you normally don’t want to have auto-generated files under source control. It can cause unnecessary conflicts, every time it’s is autogenerated. Let’s add the lib folder to .gitignore:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">node_modules  
/lib<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>The slash before lib means “Ignore only the lib folder in the top of the root” This is what we want in this case.</p>
<h1 id="Formatting-and-Linting"><a href="#Formatting-and-Linting" class="headerlink" title="Formatting and Linting"></a>Formatting and Linting</h1><p>An awesome package should include strict rules for linting and formatting. Especially if you want more collaborators later on. Let’s add <strong>Prettier</strong> and <strong>TsLint!</strong></p>
<p>Like Typescript, these are tools used only for the development of the package. They should be added as <strong>devDependencies</strong>:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev prettier tslint tslint-config-prettier<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>tslint-config-prettier</strong> is a preset we need since it prevents conflicts between tslint and prettiers formatting rules.</p>
<p>In the root, add a <strong>tslint.json</strong>:</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>  
   <span class="token property">"extends"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"tslint:recommended"</span><span class="token punctuation">,</span> <span class="token string">"tslint-config-prettier"</span><span class="token punctuation">]</span>  
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>And a <strong>.prettierrc</strong></p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>  
  <span class="token property">"printWidth"</span><span class="token operator">:</span> <span class="token number">120</span><span class="token punctuation">,</span>  
  <span class="token property">"trailingComma"</span><span class="token operator">:</span> <span class="token string">"all"</span><span class="token punctuation">,</span>  
  <span class="token property">"singleQuote"</span><span class="token operator">:</span> <span class="token boolean">true</span>  
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Finally, add the <strong>lint-</strong> and <strong>format</strong> scripts to <strong>package.json</strong></p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"format"</span><span class="token operator">:</span> <span class="token string">"prettier --write \"src/**/*.ts\" \"src/**/*.js\""</span><span class="token punctuation">,</span>  
<span class="token property">"lint"</span><span class="token operator">:</span> <span class="token string">"tslint -p tsconfig.json"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>Your <strong>package.json</strong> should now look something like this:</p>
<figure class="hg hh hi hj hk hl cx cy paragraph-image">
    ![](https://miro.medium.com/max/60/1*9w-9-ZvsKCCoXxm2ahX46A.png?q=20)![](https://miro.medium.com/max/1400/1*9w-9-ZvsKCCoXxm2ahX46A.png)
</figure>

<p>Now you can run <strong>npm run lint</strong> and <strong>npm run format</strong> in the console:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> run lint  
<span class="token function">npm</span> run <span class="token function">format</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<figure class="hg hh hi hj hk hl cx cy paragraph-image">
    ![](https://miro.medium.com/max/60/1*dHknSd2ptmxb6qlQEMuvLA.png?q=20)![](https://miro.medium.com/max/1400/1*dHknSd2ptmxb6qlQEMuvLA.png)
</figure>

<h1 id="Don’t-include-more-than-you-need-in-your-package"><a href="#Don’t-include-more-than-you-need-in-your-package" class="headerlink" title="Don’t include more than you need in your package!"></a>Don’t include more than you need in your package!</h1><p>In our <strong>.gitignore</strong> file, we added <code>/lib</code> since we don’t want the build-files in our git repository. The opposite goes for a published package. We don’t want the source code, <strong>only</strong> the build-files!</p>
<p>This can be solved in two ways. One way is to blacklist files&#x2F;folders in a <strong>.npmignore</strong> file. Should have looked something like this in our case:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">src  
tsconfig.json  
tslint.json  
.prettierrc<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>However, blacklisting files is not a good practice. Every new file&#x2F;folder added to the root, needs to be added to the <strong>.npmignore</strong> file as well! Instead, you should <strong>whitelist</strong> the files &#x2F;folders you want to publish. This can be done by adding the <strong>files</strong> property in <strong>package.json:</strong></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">“files”: <span class="token punctuation">[</span>“lib/**/*”<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>That’s it! Easy 😃 Only the lib folder will be included in the published package! (<strong>README.md</strong> and <strong>package.json</strong> are added by default).</p>
<p>For more information about whitelisting vs blacklisting in NPM packages see <a target="_blank" rel="noopener" href="https://blog.npmjs.org/post/165769683050/publishing-what-you-mean-to-publish">this post from the NPM blog</a>. (Thank you </p>
<p><a target="_blank" rel="noopener" href="https://medium.com/u/34500fc3e94?source=post_page-----44fe7164964c--------------------------------">Tibor Blénessy</a> for the reference)</p>
<h1 id="Setup-Testing-with-Jest"><a href="#Setup-Testing-with-Jest" class="headerlink" title="Setup Testing with Jest"></a>Setup Testing with Jest</h1><p>An awesome package should include unit tests! Let’s add <a target="_blank" rel="noopener" href="https://facebook.github.io/jest/"><strong>Jest</strong></a>: An awesome testing framework by Facebook.</p>
<figure class="hg hh hi hj hk hl cx cy paragraph-image">
    ![](https://miro.medium.com/max/60/1*pm9uFbR7NxtVmbyXGBQEkA.png?q=20)![](https://miro.medium.com/max/616/1*pm9uFbR7NxtVmbyXGBQEkA.png)
    <figcaption class="lg lh cz cx cy li lj ce b fa cg gr" data-selectable-paragraph="">Jest: A testing framework by Facebook</figcaption>
</figure>

<p>Since we will be writing tests against our typescript source-files, we also need to add <code>[ts-jest](https://github.com/kulshekhar/ts-jest)</code> and <code>@types/jest</code>. The test suite is only used during development so let’s add them as <strong>devDependencies</strong></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev jest ts-jest @types/jest<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Cool! Now we need to configure Jest. You can choose to write a <code>jest</code> section to <strong>package.json</strong> or to create a separate config file. We are going to add it in a separate file, so it will not be included when we publish the package.</p>
<p>Create a new file in the root and name it <strong>jestconfig.json:</strong></p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>  
  <span class="token property">"transform"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>  
    <span class="token property">"^.+\\.(t|j)sx?$"</span><span class="token operator">:</span> <span class="token string">"ts-jest"</span>  
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  
  <span class="token property">"testRegex"</span><span class="token operator">:</span> <span class="token string">"(/__tests__/.*|(\\.|/)(test|spec))\\.(jsx?|tsx?)$"</span><span class="token punctuation">,</span>  
  <span class="token property">"moduleFileExtensions"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"ts"</span><span class="token punctuation">,</span> <span class="token string">"tsx"</span><span class="token punctuation">,</span> <span class="token string">"js"</span><span class="token punctuation">,</span> <span class="token string">"jsx"</span><span class="token punctuation">,</span> <span class="token string">"json"</span><span class="token punctuation">,</span> <span class="token string">"node"</span><span class="token punctuation">]</span>  
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Remove the old test script in <strong>package.json</strong> and change it to:</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"test"</span><span class="token operator">:</span> <span class="token string">"jest --config jestconfig.json"</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>The <strong>package.json</strong> should look something like this:</p>
<figure class="hg hh hi hj hk hl cx cy paragraph-image">
    ![](https://miro.medium.com/max/60/1*TGomRekCAxgj_ZCDKIUjDQ.png?q=20)![](https://miro.medium.com/max/1400/1*TGomRekCAxgj_ZCDKIUjDQ.png)
</figure>

<h1 id="Write-a-basic-test"><a href="#Write-a-basic-test" class="headerlink" title="Write a basic test"></a>Write a basic test</h1><p>It’s time to write our first test! 😃</p>
<p>In the <code>src</code> folder, add a new folder called <code>__tests__</code> and inside, add a new file with a name you like, but it has to end with <code>test.ts</code>, for example <code>Greeter.test.ts</code></p>
<pre class="line-numbers language-Typescript" data-language="Typescript"><code class="language-Typescript">import &#123; Greeter &#125; from &#39;..&#x2F;index&#39;;

test(&#39;My Greeter&#39;, () &#x3D;&gt; &#123;  
  expect(Greeter(&#39;Carl&#39;)).toBe(&#39;Hello Carl&#39;);  
&#125;);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Ok, so the only thing we are doing here is to verify that Our method <code>Greeter</code> will return <code>Hello Carl</code> if the input is <code>Carl</code>.</p>
<p>Now, Try to run</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> <span class="token builtin class-name">test</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<figure class="hg hh hi hj hk hl cx cy paragraph-image">
    ![](https://miro.medium.com/max/60/1*M3fP4j97jMmURFCz4rM1Og.png?q=20)![](https://miro.medium.com/max/1400/1*M3fP4j97jMmURFCz4rM1Og.png)
</figure>

<p>Cool it works! As you can see we passed one test.</p>
<h1 id="Use-the-magic-scripts-in-NPM"><a href="#Use-the-magic-scripts-in-NPM" class="headerlink" title="Use the magic scripts in NPM"></a>Use the magic scripts in NPM</h1><p>For an awesome package, we should of course automate as much as possible. We’re about to dig into some scripts in npm: <strong>prepare</strong>, <strong>prepublishOnly</strong>, <strong>preversion</strong>, <strong>version</strong> and <strong>postversion</strong></p>
<p><strong>prepare</strong> will run both BEFORE the package is packed and published, and on local <code>npm install</code>. Perfect for running building the code. Add this script to <strong>package.json</strong></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token string">"prepare"</span> <span class="token builtin class-name">:</span> <span class="token string">"npm run build"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>prepublishOnly</strong> will run BEFORE <strong>prepare</strong> and ****ONLY on <code>**npm publish**</code>. Here we will run our test and lint to make sure we don’t publish bad code:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token string">"prepublishOnly"</span> <span class="token builtin class-name">:</span> <span class="token string">"npm test &amp;&amp; npm run lint"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>preversion</strong> will run before bumping a new package version. To be extra sure that we’re not bumping a version with bad code, why not run lint here as well? 😃</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token string">"preversion"</span> <span class="token builtin class-name">:</span> <span class="token string">"npm run lint"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>Version</strong> will run after a new version has been bumped. If your package has a git repository, like in our case, a commit and a new version-tag will be made every time you bump a new version. This command will run BEFORE the commit is made. One idea is to run the formatter here and so no ugly code will pass into the new version:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token string">"version"</span> <span class="token builtin class-name">:</span> <span class="token string">"npm run format &amp;&amp; git add -A src"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>Postversion</strong> will run after the commit has been made. A perfect place for pushing the commit as well as the tag.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token string">"postversion"</span> <span class="token builtin class-name">:</span> <span class="token string">"git push &amp;&amp; git push --tags"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>This is how my scripts section in <strong>package.json</strong> looks like:</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>  
   <span class="token property">"test"</span><span class="token operator">:</span> <span class="token string">"jest --config jestconfig.json"</span><span class="token punctuation">,</span>  
   <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"tsc"</span><span class="token punctuation">,</span>  
   <span class="token property">"format"</span><span class="token operator">:</span> <span class="token string">"prettier --write \"src/**/*.ts\" \"src/**/*.js\""</span><span class="token punctuation">,</span>  
   <span class="token property">"lint"</span><span class="token operator">:</span> <span class="token string">"tslint -p tsconfig.json"</span><span class="token punctuation">,</span>  
   <span class="token property">"prepare"</span><span class="token operator">:</span> <span class="token string">"npm run build"</span><span class="token punctuation">,</span>  
   <span class="token property">"prepublishOnly"</span><span class="token operator">:</span> <span class="token string">"npm test &amp;&amp; npm run lint"</span><span class="token punctuation">,</span>  
   <span class="token property">"preversion"</span><span class="token operator">:</span> <span class="token string">"npm run lint"</span><span class="token punctuation">,</span>  
   <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"npm run format &amp;&amp; git add -A src"</span><span class="token punctuation">,</span>  
   <span class="token property">"postversion"</span><span class="token operator">:</span> <span class="token string">"git push &amp;&amp; git push --tags"</span>  
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="Finishing-up-package-json"><a href="#Finishing-up-package-json" class="headerlink" title="Finishing up package.json"></a>Finishing up package.json</h1><p>It’s finally time to finish up our awesome package! First, we need to make some changes to our <strong>package.json</strong> again:</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>  
   <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"my-awesome-greeter"</span><span class="token punctuation">,</span>  
   <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>  
   **<span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"A nice greeter"</span><span class="token punctuation">,</span>**  
  ** <span class="token property">"main"</span><span class="token operator">:</span> <span class="token string">"lib/index.js"</span><span class="token punctuation">,</span>  
   <span class="token property">"types"</span><span class="token operator">:</span> <span class="token string">"lib/index.d.ts"</span><span class="token punctuation">,</span>**  
   <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>  
      <span class="token property">"test"</span><span class="token operator">:</span> <span class="token string">"jest --config jestconfig.json"</span><span class="token punctuation">,</span>  
      <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"tsc"</span><span class="token punctuation">,</span>  
      <span class="token property">"format"</span><span class="token operator">:</span> <span class="token string">"prettier --write \"src/**/*.ts\" \"src/**/*.js\""</span><span class="token punctuation">,</span>  
      <span class="token property">"lint"</span><span class="token operator">:</span> <span class="token string">"tslint -p tsconfig.json"</span><span class="token punctuation">,</span>  
      <span class="token property">"prepare"</span><span class="token operator">:</span> <span class="token string">"npm run build"</span><span class="token punctuation">,</span>  
      <span class="token property">"prepublishOnly"</span><span class="token operator">:</span> <span class="token string">"npm test &amp;&amp; npm run lint"</span><span class="token punctuation">,</span>  
      <span class="token property">"preversion"</span><span class="token operator">:</span> <span class="token string">"npm run lint"</span><span class="token punctuation">,</span>  
      <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"npm run format &amp;&amp; git add -A src"</span><span class="token punctuation">,</span>  
      <span class="token property">"postversion"</span><span class="token operator">:</span> <span class="token string">"git push &amp;&amp; git push --tags"</span>  
   <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  
   <span class="token property">"repository"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>  
     <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"git"</span><span class="token punctuation">,</span>  
     <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"git+https://github.com/caki0915/my-awesome-greeter.git"</span>  
   <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  
  ** <span class="token property">"keywords"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"Hello"</span><span class="token punctuation">,</span> <span class="token string">"Greeter"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  
   <span class="token property">"author"</span><span class="token operator">:</span> <span class="token string">"C-J"</span><span class="token punctuation">,</span>**  
   ....<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Se here we are adding a nice description, an author and some relevant keywords. The key <strong>main</strong> is important here since it will tell <strong>npm</strong> where it can import the modules from.<br>The key <strong>types</strong> will ****tell Typescript and Code-editors where we can find the type definitions!</p>
<h1 id="Commit-and-push-your-code-to-git"><a href="#Commit-and-push-your-code-to-git" class="headerlink" title="Commit and push your code to git"></a>Commit and push your code to git</h1><p>Time to push all your work to your remote repository! If you haven’t committed your latest code already, now it is the time to do it. 😉</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> <span class="token function">add</span> -A <span class="token operator">&amp;&amp;</span> <span class="token function">git</span> commit -m <span class="token string">"Setup Package"</span>  
<span class="token function">git</span> push<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h1 id="Publish-you-package-to-NPM"><a href="#Publish-you-package-to-NPM" class="headerlink" title="Publish you package to NPM!"></a>Publish you package to NPM!</h1><p>In order to publish your package, you need to create an NPM account.<br>If you don’t have an account you can do so on <a target="_blank" rel="noopener" href="https://www.npmjs.com/signup">https://www.npmjs.com/signup</a><br>or run the command: <code>npm adduser</code></p>
<p>If you already have an account, run <code>npm login</code> to login to you NPM account.</p>
<figure class="hg hh hi hj hk hl cx cy paragraph-image">
    ![](https://miro.medium.com/max/60/1*mNgzLzJuwiXoezbaPGICfA.png?q=20)![](https://miro.medium.com/max/1400/1*mNgzLzJuwiXoezbaPGICfA.png)
    <figcaption class="lg lh cz cx cy li lj ce b fa cg gr" data-selectable-paragraph="">Logging in to my existing NPM account</figcaption>
</figure>

<p>Alright! Now run publish.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> publish<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>As you can see the package will first be built by the <strong>prepare</strong> script, then <strong>test</strong> and <strong>lint</strong> will run by the <strong>prepublishOnly</strong> script before the package is published.</p>
<figure class="hg hh hi hj hk hl cx cy paragraph-image">
    ![](https://miro.medium.com/max/54/1*EC-rs2IVwyHypVwsI8e22g.png?q=20)![](https://miro.medium.com/max/1400/1*EC-rs2IVwyHypVwsI8e22g.png)
</figure>

<h1 id="View-your-package"><a href="#View-your-package" class="headerlink" title="View your package"></a>View your package</h1><p>Now browse your package on <strong>npmjs.</strong> The url is *<em><strong><a target="_blank" rel="noopener" href="https://npmjs.com/package/">https://npmjs.com/package/</a></strong><your-package-name></em>* in my case it is  ****<a target="_blank" rel="noopener" href="https://npmjs.com/package/my-awesome-greeter"><strong>https://npmjs.com/package/my-awesome-greeter</strong></a></p>
<figure class="hg hh hi hj hk hl cx cy paragraph-image">
    ![](https://miro.medium.com/max/60/1*eW39LTEkcc2RBlXRNoG7eg.png?q=20)![](https://miro.medium.com/max/1400/1*eW39LTEkcc2RBlXRNoG7eg.png)
</figure>

<p>Nice! We got a package 😎 📦 looking good so far!</p>
<h1 id="Bumping-a-new-version"><a href="#Bumping-a-new-version" class="headerlink" title="Bumping a new version"></a>Bumping a new version</h1><p>Let’s bump a new patch version of the package:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> version patch<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Our <strong>preversion</strong>, <strong>version,</strong> and <strong>postversion</strong> will run, create a new tag in git and push it to our remote repository. Now publish again:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> publish<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>And now you have a new version</p>
<figure class="hg hh hi hj hk hl cx cy paragraph-image">
    ![](https://miro.medium.com/max/60/1*VqYCMBF4h3eDBYQoC4ucfw.png?q=20)![](https://miro.medium.com/max/1400/1*VqYCMBF4h3eDBYQoC4ucfw.png)
    <figcaption class="lg lh cz cx cy li lj ce b fa cg gr" data-selectable-paragraph="">New version in NPM</figcaption>
</figure>

<figure class="hg hh hi hj hk hl cx cy paragraph-image">
    ![](https://miro.medium.com/max/60/1*HiO5DaYGsLzRKsVLj03Y1g.png?q=20)![](https://miro.medium.com/max/1400/1*HiO5DaYGsLzRKsVLj03Y1g.png)
    <figcaption class="lg lh cz cx cy li lj ce b fa cg gr" data-selectable-paragraph="">New Release in Github</figcaption>
</figure>

<h1 id="What’s-next"><a href="#What’s-next" class="headerlink" title="What’s next?"></a>What’s next?</h1><p>For the scope of this tutorial, I would like to stop here for now on something I would call a <em>“minimum setup for an NPM Package”.</em> However, when your package grows I would recommend:</p>
<ul>
<li>Setup automated build with <a target="_blank" rel="noopener" href="https://travis-ci.org/">Travis</a></li>
<li>Analyze code-coverage with <a target="_blank" rel="noopener" href="https://codecov.io/">Codecov</a></li>
<li>Add badges to your readme with <a target="_blank" rel="noopener" href="http://shields.io/">Shields</a>. Everyone loves badges 😎</li>
</ul>
<p>But let’s leave that for another tutorial.</p>
<h1 id="Good-luck-building-your-awesome-package-😃"><a href="#Good-luck-building-your-awesome-package-😃" class="headerlink" title="Good luck building your awesome package! 😃"></a>Good luck building your awesome package! 😃</h1>
                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        Author:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Potar</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        Link:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://example.com/2022/08/22/ts/npm-package-publish/">http://example.com/2022/08/22/ts/npm-package-publish/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        Reprint policy:
                    </i>
                </span>
                <span class="reprint-info">
                    All articles in this blog are used except for special statements
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    reprint policy. If reproduced, please indicate source
                    <a href="/about" target="_blank">Potar</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>Copied successfully, please follow the reprint policy of this article</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">more</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/ts/">
                                    <span class="chip bg-color">ts</span>
                                </a>
                            
                                <a href="/tags/typescript/">
                                    <span class="chip bg-color">typescript</span>
                                </a>
                            
                                <a href="/tags/npm/">
                                    <span class="chip bg-color">npm</span>
                                </a>
                            
                                <a href="/tags/node/">
                                    <span class="chip bg-color">node</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;Previous</div>
            <div class="card">
                <a href="/2022/08/22/ts/npm-package-publish-2/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/2.jpg" class="responsive-img" alt="简单改动后的发包">
                        
                        <span class="card-title">简单改动后的发包</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2022-08-22
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Typescript/" class="post-category">
                                    Typescript
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/ts/">
                        <span class="chip bg-color">ts</span>
                    </a>
                    
                    <a href="/tags/typescript/">
                        <span class="chip bg-color">typescript</span>
                    </a>
                    
                    <a href="/tags/npm/">
                        <span class="chip bg-color">npm</span>
                    </a>
                    
                    <a href="/tags/node/">
                        <span class="chip bg-color">node</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                Next&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2022/08/22/mac/update-chromedriver/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/7.jpg" class="responsive-img" alt="Mac 更新chromedriver的脚本">
                        
                        <span class="card-title">Mac 更新chromedriver的脚本</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2022-08-22
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/MacOs/" class="post-category">
                                    MacOs
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Mac/">
                        <span class="chip bg-color">Mac</span>
                    </a>
                    
                    <a href="/tags/chromedriver/">
                        <span class="chip bg-color">chromedriver</span>
                    </a>
                    
                    <a href="/tags/selenium/">
                        <span class="chip bg-color">selenium</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- 是否加载使用自带的 prismjs. -->
  <script type="text/javascript" src="/libs/prism/prism.min.js"></script>


<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;TOC</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('3'),
            headingSelector: 'h1,h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2022</span>
            
            <a href="/about" target="_blank">Potar</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;Total visits:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;Total visitors:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/blinkfox" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:1181062873@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1181062873" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1181062873" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;Search</span>
            <input type="search" id="searchInput" name="s" placeholder="Please enter a search keyword"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
